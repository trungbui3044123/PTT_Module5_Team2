<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Danh sách người dùng</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f5f5f5;
        padding: 20px;
      }

      .title {
        text-align: center;
        margin-bottom: 20px;
      }

      #userTable {
        width: 100%;
        border-collapse: collapse;
        background: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      #userTable th,
      #userTable td {
        padding: 10px;
        border: 1px solid #ddd;
        text-align: left;
      }

      #userTable th {
        background: #007bff;
        color: white;
      }

      #userTable tr:nth-child(even) {
        background: #f2f2f2;
      }

      #userTable tr:hover {
        background: #e6f3ff;
      }
    </style>
  </head>
  <body>
    <div><br><br><button id="homePage">Back Home page</button></div>
    <h2 class="title">Danh sách người dùng</h2>

    <table id="userTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Username</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Name</th>
          <th>Age</th>
          <th>Address</th>
          <th>Role</th>
          <th>Status</th>
          <th>Salary</th>
        </tr>
      </thead>
      <tbody id="userBody">
        <!-- JS sẽ render vào đây -->
      </tbody>
    </table>

    <script>
    const token = localStorage.getItem("token");

      if (!token) {
          window.location.href = "http://127.0.0.1:5500/Fe/Pages/Admin/Login.html";
      }
    const tbody = document.getElementById("userBody");

            function renderUsers(users) {
              tbody.innerHTML = "";
              users.forEach((u) => {
                const row = ` <tr> <td>${u.id}</td> <td>${u.username}</td> <td>${u.email}</td> <td>${u.phone}</td> <td>${u.name}</td> <td>${u.age}</td> <td>${u.address}</td> <td>${u.role}</td> <td>${u.status}</td> <td>${u.role === "STAFF" ? u.salary : "-"}</td> </tr> `;
                tbody.innerHTML += row;
              });
            }
    fetch("http://localhost:8080/api/admin/users",{
                      method: "GET",
                      headers: {
                          "Content-Type": "application/json",
                          "Authorization": "Bearer " + token
                      }})
            .then(res=>res.json())          
            .then(result=>{
              if(result.status===200){
              renderUsers(result.data.content);

              }else{
                  const error=document.createElement("h3")
                  error.innerHTML = "No data ";
                  tbody.appendChild(error);
              }

            })

document.getElementById("homePage").addEventListener("click",function(e){
    e.preventDefault();
   window.location.href = "http://127.0.0.1:5500/Fe/Pages/Admin/Dashboard.html";
})

    </script>
  </body>
</html>
